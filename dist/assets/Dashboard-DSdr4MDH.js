import{u as N,r as o,A as k,j as e}from"./index-c3ra4aFo.js";function C(){const m=N(),{currentUser:g,subjects:r,attendanceRecords:x,addAttendanceRecord:p}=o.useContext(k),[t,c]=o.useState({subject:r.length>0&&r[0]?.name||"",date:new Date().toISOString().split("T")[0],status:"Present"});o.useEffect(()=>{r.length>0&&!t.subject&&c(s=>({...s,subject:r[0]?.name||""}))},[r]);const[a,h]=o.useState(null),[d,b]=o.useState(!1),[n,i]=o.useState({text:"",type:""});o.useEffect(()=>{if(t.subject&&t.date){const s=x.find(l=>l.subject&&l.subject.name===t.subject&&l.date===t.date);h(s)}else h(null)},[t.subject,t.date,x]);const u=s=>{const{name:l,value:y}=s.target;c({...t,[l]:y}),n.text&&i({text:"",type:""})},f=s=>{if(s.preventDefault(),a){i({text:"Record already exists. Please go to History page to update.",type:"error"});return}b(!0);try{p(t),i({text:"Attendance recorded successfully!",type:"success"}),c({subject:r.length>0&&r[0]?.name||"",date:new Date().toISOString().split("T")[0],status:"Present"})}catch{i({text:"An error occurred. Please try again.",type:"error"})}b(!1),setTimeout(()=>{i({text:"",type:""})},3e3)},v=()=>{m("/reports")},w=()=>{m("/history")},j=g?.username||"User";return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-indigo-50 to-blue-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-6xl relative",children:[e.jsx("div",{className:"absolute top-20 right-10 w-32 h-32 bg-gradient-to-br from-purple-300 to-indigo-300 rounded-full opacity-20 blur-xl animate-pulse-slow"}),e.jsx("div",{className:"absolute bottom-20 left-5 w-28 h-28 bg-gradient-to-br from-blue-400 to-cyan-300 rounded-full opacity-20 blur-xl"}),e.jsx("div",{className:"absolute top-40 left-10 w-20 h-20 bg-gradient-to-br from-pink-400 to-purple-300 rounded-full opacity-20 blur-xl"}),e.jsx("div",{className:"absolute bottom-40 right-20 w-24 h-24 bg-gradient-to-br from-cyan-300 to-teal-300 rounded-full opacity-20 blur-xl"}),e.jsxs("div",{className:"mb-8 bg-gradient-to-r from-violet-600 via-indigo-600 to-blue-600 rounded-xl p-6 text-white shadow-xl relative overflow-hidden",children:[e.jsxs("div",{className:"absolute top-0 right-0 w-full h-full",children:[e.jsx("svg",{className:"absolute right-0 top-0 h-full opacity-10",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:e.jsx("path",{d:"M0,0 L100,0 L100,100 Z",fill:"white"})}),e.jsx("div",{className:"absolute right-10 top-5 w-20 h-20 bg-white rounded-full opacity-10"}),e.jsx("div",{className:"absolute right-20 bottom-5 w-10 h-10 bg-white rounded-full opacity-10"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-white",children:["Welcome, ",e.jsx("span",{className:"font-extrabold",children:j}),"!"]}),e.jsx("p",{className:"mt-2 text-white text-sm md:text-base font-medium",children:"Track your attendance and maintain your academic records easily."})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 space-y-4 sm:space-y-0 relative z-10",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Record Attendance"}),e.jsx("div",{className:"flex space-x-3 w-full sm:w-auto",children:e.jsxs("button",{onClick:v,className:"bg-gradient-to-r from-indigo-800 to-purple-900 hover:from-indigo-900 hover:to-purple-950 text-white font-medium py-2.5 px-4 rounded-lg flex items-center transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 active:translate-y-0 w-full sm:w-auto justify-center border border-indigo-700",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Reports"]})})]}),n.text&&e.jsx("div",{className:`mb-6 p-4 rounded-lg shadow-md border-l-4 transition-all duration-300 ease-in-out ${n.type==="success"?"bg-gradient-to-r from-green-50 to-emerald-50 text-green-700 border-green-500":"bg-gradient-to-r from-red-50 to-rose-50 text-red-700 border-red-500"}`,children:e.jsxs("div",{className:"flex items-center",children:[n.type==="success"?e.jsx("svg",{className:"w-5 h-5 mr-2 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):e.jsx("svg",{className:"w-5 h-5 mr-2 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),n.text]})}),e.jsxs("div",{className:"bg-white bg-opacity-80 backdrop-blur-md rounded-xl shadow-xl p-6 border border-gray-100 relative z-10",children:[a&&e.jsxs("div",{className:"mb-6 bg-amber-50 border border-amber-300 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"bg-amber-100 px-4 py-2 border-b border-amber-300",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-semibold text-amber-800",children:"Existing Record Found"})]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("p",{className:"text-amber-800",children:['"An attendance record already exists for ',e.jsx("strong",{children:t.subject})," on ",e.jsx("strong",{children:new Date(t.date).toLocaleDateString()}),'. To make changes, please delete the existing entry from the History page and then submit a new record."']}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-amber-800 font-medium",children:"Current status:"}),e.jsx("span",{className:`font-semibold px-3 py-1 rounded-full text-sm 
                    ${a.status==="Present"?"bg-green-100 text-green-800":a.status==="Absent"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:a.status})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-amber-200",children:e.jsxs("button",{onClick:w,className:"w-full bg-gray-700 text-white font-medium py-2.5 px-4 rounded-lg flex items-center justify-center transition-colors duration-200 shadow-md border border-gray-600 hover:bg-gray-800",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Go to History"]})})]})]}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-1",htmlFor:"subject",children:"Subject"}),r.length>0?e.jsxs("div",{className:"relative",children:[e.jsx("select",{id:"subject",name:"subject",className:"appearance-none font-bold text-black block w-full bg-white bg-opacity-80 backdrop-blur-sm border border-gray-300 rounded-lg py-2.5 px-4 pr-8 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 hover:border-blue-400",value:t.subject,onChange:u,required:!0,style:{maxWidth:"100%",textOverflow:"ellipsis"},children:r.map(s=>e.jsx("option",{value:s.name,style:{overflow:"hidden",textOverflow:"ellipsis"},children:s.name},s.id))}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx("svg",{className:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}):e.jsx("div",{className:"bg-gradient-to-r from-yellow-50 to-amber-50 border-l-4 border-yellow-400 text-yellow-700 p-4 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{children:"No subjects available. Please add subjects in Settings."})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-1",htmlFor:"date",children:"Date"}),e.jsx("input",{id:"date",name:"date",type:"date",className:"appearance-none font-bold text-black block w-full bg-white bg-opacity-80 backdrop-blur-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 hover:border-blue-400",value:t.date,onChange:u,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-1",htmlFor:"status",children:"Status"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"status",name:"status",className:"appearance-none font-bold text-black block w-full bg-white bg-opacity-80 backdrop-blur-sm border border-gray-300 rounded-lg py-2.5 px-4 pr-8 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 hover:border-blue-400",value:t.status,onChange:u,required:!0,children:[e.jsx("option",{value:"Present",children:"Present"}),e.jsx("option",{value:"Absent",children:"Absent"}),e.jsx("option",{value:"No Class",children:"No Class"})]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx("svg",{className:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})]}),e.jsx("div",{className:"pt-2",children:!a&&e.jsx("button",{type:"submit",className:`
                    ${d?"bg-gray-700 cursor-not-allowed":"bg-gradient-to-r from-blue-800 to-indigo-900 hover:from-blue-900 hover:to-indigo-950"} 
                    text-white font-medium py-2.5 px-6 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 
                    focus:ring-blue-700
                    transition-all duration-200 w-full sm:w-auto shadow-md hover:shadow-lg transform hover:-translate-y-0.5 active:translate-y-0
                    border ${d?"border-gray-600":"border-blue-700"}
                  `,disabled:r.length===0||d,children:d?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Record Attendance"]})})})]})]})]})})}export{C as default};
